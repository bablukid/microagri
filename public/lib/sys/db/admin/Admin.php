<?php
/**
 * Generated by Haxe 4.0.0-rc.1+1fdd3d5
 */

namespace sys\db\admin;

use \php\_Boot\HxAnon;
use \php\Boot;
use \haxe\CallStack;
use \sys\db\Object_hx;
use \php\Lib;
use \php\Web;
use \sys\db\Manager;
use \sys\db\ResultSet;
use \sys\db\RecordType;
use \php\_Boot\HxString;
use \haxe\ds\List_hx;
use \haxe\ds\StringMap;
use \haxe\Unserializer;
use \php\_Boot\HxException;
use \php\_NativeIndexedArray\NativeIndexedArrayIterator;
use \haxe\Serializer;

class Admin {
	/**
	 * @var bool
	 */
	public $allowDrop;
	/**
	 * @var StringMap
	 */
	public $countCache;
	/**
	 * @var object
	 */
	public $default_rights;
	/**
	 * @var bool
	 */
	public $hasSyncAction;
	/**
	 * @var int
	 */
	public $maxInstanceCount;
	/**
	 * @var int
	 */
	public $maxUploadSize;
	/**
	 * @var AdminStyle
	 */
	public $style;

	/**
	 * @return void
	 */
	static public function handler () {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1139: characters 3-23
		Manager::initialize();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1140: lines 1140-1151
		try {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1141: characters 4-25
			(new Admin())->process();
		} catch (\Throwable $__hx__caught_e) {
			CallStack::saveExceptionTrace($__hx__caught_e);
			$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
			$e = $__hx__real_e;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1145: characters 4-26
			Manager::$cnx->rollback();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1147: characters 4-47
			echo(\Std::string("<h2>Error :</h2>" . (\Std::string($e)??'null')));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1148: characters 4-38
			echo("<h2>Stack :</h2><pre>");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1149: characters 4-71
			echo(\Std::string(CallStack::toString(CallStack::exceptionStack())));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1150: characters 4-23
			echo("</pre>");
		}
	}

	/**
	 * @param bool $initIndexes
	 * @param bool $initRelations
	 * 
	 * @return void
	 */
	static public function initializeDatabase ($initIndexes = true, $initRelations = true) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1154: lines 1154-1167
		if ($initIndexes === null) {
			$initIndexes = true;
		}
		if ($initRelations === null) {
			$initRelations = true;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1155: characters 3-23
		$a = new Admin();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1156: characters 3-30
		$tables = $a->getTables();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1157: lines 1157-1158
		$_g = 0;
		while ($_g < $tables->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1157: characters 8-9
			$t = ($tables->arr[$_g] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1157: lines 1157-1158
			++$_g;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1158: characters 4-37
			$a->execute($t->createRequest(false));
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1159: lines 1159-1166
		$_g1 = 0;
		while ($_g1 < $tables->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1159: characters 8-9
			$t1 = ($tables->arr[$_g1] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1159: lines 1159-1166
			++$_g1;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1160: lines 1160-1162
			if ($initIndexes) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1161: characters 15-24
				$_g1_head = $t1->indexes->h;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1161: lines 1161-1162
				while ($_g1_head !== null) {
					$val = $_g1_head->item;
					$_g1_head = $_g1_head->next;
					$i = $val;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1162: characters 6-66
					$a->execute($t1->addIndexRequest(\Lambda::array($i->keys), $i->unique));
				}
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1163: lines 1163-1165
			if ($initRelations) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1164: lines 1164-1165
				$_g11 = 0;
				$_g2 = $t1->relations;
				while ($_g11 < $_g2->length) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1164: characters 10-11
					$r = ($_g2->arr[$_g11] ?? null);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1164: lines 1164-1165
					++$_g11;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1165: characters 6-52
					$a->execute($t1->addRelationRequest($r->key, $r->prop));
				}
			}
		}

	}

	/**
	 * @param string $msg
	 * 
	 * @return void
	 */
	static public function log ($msg) {
	}

	/**
	 * @return void
	 */
	public function __construct () {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:51: characters 3-25
		$this->maxInstanceCount = 100;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:52: characters 3-26
		$this->maxUploadSize = 1000000;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:53: characters 3-20
		$this->allowDrop = false;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:54: characters 3-25
		$this->countCache = new StringMap();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:55: lines 55-64
		$this->default_rights = new HxAnon([
			"can" => new HxAnon([
				"insert" => true,
				"delete" => true,
				"modify" => true,
				"truncate" => false,
			]),
			"invisible" => new \Array_hx(),
			"readOnly" => new \Array_hx(),
		]);
	}

	/**
	 * @param string $sql
	 * 
	 * @return bool
	 */
	public function boolResult ($sql) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:76: lines 76-81
		try {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:77: characters 4-16
			$this->execute($sql);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:78: characters 4-15
			return true;
		} catch (\Throwable $__hx__caught_e) {
			CallStack::saveExceptionTrace($__hx__caught_e);
			$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
			$e = $__hx__real_e;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:80: characters 4-16
			return false;
		}
	}

	/**
	 * @param object $m
	 * 
	 * @return bool
	 */
	public function canDisplay ($m) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:202: characters 3-40
		$c = ($this->countCache->data[$m->table_name] ?? null);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:203: lines 203-204
		if ($c !== null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:204: characters 4-12
			return $c;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:205: characters 3-85
		$c = $this->execute(TableInfos::countRequest($m, $this->maxInstanceCount))->get_length() < $this->maxInstanceCount;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:206: characters 3-33
		$this->countCache->data[$m->table_name] = $c;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:207: characters 3-11
		return $c;
	}

	/**
	 * Filter classes who sublass sys.db.Object and get TableInfos
	 * 
	 * @param \Array_hx $tables
	 * @param mixed $classes
	 * 
	 * @return void
	 */
	public function crawl ($tables, $classes) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:106: lines 106-127
		$_g = 0;
		$_g1 = \Reflect::fields($classes);
		while ($_g < $_g1->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:106: characters 8-13
			$cname = ($_g1->arr[$_g] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:106: lines 106-127
			++$_g;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:108: characters 4-51
			$v = \Reflect::field($classes, $cname);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:109: characters 4-28
			$c = mb_substr($cname, 0, 1);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:110: lines 110-114
			if (strcmp($c, "a") >= 0 && strcmp($c, "z") <= 0) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:112: characters 5-20
				$this->crawl($tables, $v);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:113: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:119: characters 4-34
			$s = \Type::getSuperClass($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:120: lines 120-126
			while ($s !== null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:121: lines 121-124
				if ($s === Boot::getClass(Object_hx::class)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:122: characters 6-55
					$x = new TableInfos(\Type::getClassName($v));
					$tables->arr[$tables->length] = $x;
					++$tables->length;

					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:123: characters 6-11
					break;
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:125: characters 5-30
				$s = \Type::getSuperClass($s);
			}
		}
	}

	/**
	 * @param TableInfos $table
	 * 
	 * @return Object_hx
	 */
	public function createInstance ($table) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:433: characters 3-46
		$c = \Type::createEmptyInstance($table->cl);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:435: characters 11-66
		if ($c->_manager === null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:435: characters 37-66
			$c->_manager = $c->__getManager();
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:437: characters 3-11
		return $c;
	}

	/**
	 * @param TableInfos $table
	 * 
	 * @return void
	 */
	public function doCleanup ($table) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:532: lines 532-533
		if (!$this->getRights(null, $table)->can->truncate) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:533: characters 4-9
			throw new HxException("Can't cleanup");
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:534: characters 3-35
		$this->execute($table->truncateRequest());
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:535: characters 3-21
		$this->style->redirect("");
	}

	/**
	 * @param TableInfos $table
	 * 
	 * @return void
	 */
	public function doCreate ($table) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:516: lines 516-521
		try {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:517: characters 4-39
			$this->execute($table->createRequest(false));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:518: characters 4-22
			$this->style->redirect("");
		} catch (\Throwable $__hx__caught_e) {
			CallStack::saveExceptionTrace($__hx__caught_e);
			$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
			$e = $__hx__real_e;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:520: characters 4-24
			$this->index(\Std::string($e));
		}
	}

	/**
	 * Deletes a record
	 * 
	 * @param TableInfos $table
	 * @param string $id
	 * 
	 * @return void
	 */
	public function doDelete ($table, $id) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:683: characters 3-39
		$inst = $table->fromIdentifier($id);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:684: lines 684-687
		if ($inst === null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:685: characters 4-47
			$this->style->redirect(($table->className??'null') . "/edit/" . ($id??'null'));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:686: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:688: lines 688-691
		if (!$this->getRights($inst)->can->delete) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:689: characters 4-43
			$this->edit($table, $id, null, null, "Can't Delete");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:690: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:692: characters 3-16
		$inst->delete();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:693: characters 3-36
		Admin::log("Deleted " . ($table->name??'null') . " " . ($id??'null'));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:694: characters 3-21
		$this->style->redirect("");
	}

	/**
	 * @param TableInfos $table
	 * @param string $id
	 * @param string $field
	 * 
	 * @return void
	 */
	public function doDownload ($table, $id, $field) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:698: characters 3-39
		$inst = $table->fromIdentifier($id);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:699: lines 699-702
		if ($inst === null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:700: characters 4-47
			$this->style->redirect(($table->className??'null') . "/edit/" . ($id??'null'));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:701: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:703: characters 3-32
		$rights = $this->getRights($inst);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:704: characters 3-36
		$f = ($table->hfields->data[$field] ?? null);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:705: characters 3-49
		$data = \Reflect::field($inst, $field);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:706: lines 706-709
		if ($this->has($rights->invisible, $field) || ($data === null) || !$this->isBinary($f)) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:707: characters 4-50
			$this->edit($table, $id, null, null, "Can't Download data");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:708: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:710: characters 3-46
		header("Content-Type" . ": " . "text/binary");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:711: characters 3-58
		header("Content-Length" . ": " . (\Std::string(mb_strlen($data))??'null'));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:712: characters 3-18
		echo(\Std::string($data));
	}

	/**
	 * @param TableInfos $table
	 * 
	 * @return void
	 */
	public function doDrop ($table) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:525: lines 525-526
		if (!$this->allowDrop) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:526: characters 4-9
			throw new HxException("Drop not allowed");
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:527: characters 3-31
		$this->execute($table->dropRequest());
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:528: characters 3-21
		$this->style->redirect("");
	}

	/**
	 * @param TableInfos $table
	 * @param string $id
	 * @param StringMap $params
	 * 
	 * @return void
	 */
	public function doEdit ($table, $id, $params) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:583: characters 3-39
		$inst = $table->fromIdentifier($id);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:584: lines 584-587
		if ($inst === null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:585: characters 4-47
			$this->style->redirect(($table->className??'null') . "/edit/" . ($id??'null'));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:586: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:588: characters 3-29
		$this->updateParams($table, $params);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:589: characters 3-32
		$rights = $this->getRights($inst);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:590: characters 3-29
		$binaries = new List_hx();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:591: characters 13-25
		$_g_head = $table->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:591: lines 591-620
		while ($_g_head !== null) {
			$val = $_g_head->item;
			$_g_head = $_g_head->next;
			$f = $val;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:592: lines 592-593
			if ($this->has($rights->readOnly, $f->name) || $this->has($rights->invisible, $f->name)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:593: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:594: characters 4-31
			$v = ($params->data[$f->name] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:595: lines 595-599
			if ($v === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:596: lines 596-597
				if (array_key_exists($f->name, $table->nulls->data)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:597: characters 6-40
					\Reflect::setField($inst, $f->name, null);
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:598: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:600: characters 4-19
			$msg = null;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:601: characters 4-98
			$v1 = null;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:601: characters 12-97
			try {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:601: characters 4-98
				$v1 = $this->updateField($f->name, $v, $f->type, $table);
			} catch (\Throwable $__hx__caught_e) {
				CallStack::saveExceptionTrace($__hx__caught_e);
				$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
				$err = $__hx__real_e;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:601: characters 79-82
				$msg = $err;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:601: characters 4-98
				$v1 = null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:602: lines 602-613
			if ($v1 === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:604: lines 604-607
				if ($table->primary !== null) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:605: characters 16-29
					$_g_head1 = $table->primary->h;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:605: lines 605-606
					while ($_g_head1 !== null) {
						$val1 = $_g_head1->item;
						$_g_head1 = $_g_head1->next;
						$p = $val1;
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:606: characters 7-42
						$value = \Reflect::field($inst, $p);
						$params->data[$p] = $value;

					}
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:608: lines 608-609
				$_g = 0;
				$_g1 = $rights->readOnly;
				while ($_g < $_g1->length) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:608: characters 10-11
					$f1 = ($_g1->arr[$_g] ?? null);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:608: lines 608-609
					++$_g;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:609: characters 6-43
					$value1 = \Reflect::field($inst, $f1);
					$params->data[$f1] = $value1;

				}

				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:611: characters 5-38
				$this->edit($table, $id, $params, $f->name, $msg);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:612: characters 5-11
				return;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:614: characters 4-31
			$bin = $this->isBinary($f->type);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:615: lines 615-616
			if (Boot::is($v1, Boot::getClass('String')) && ($v1 === "") && $bin) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:616: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:617: characters 4-35
			\Reflect::setField($inst, $f->name, $v1);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:618: lines 618-619
			if ($bin) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:619: characters 5-47
				$binaries->add(new HxAnon([
					"name" => $f->name,
					"value" => $v1,
				]));
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:621: lines 621-633
		try {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:622: lines 622-623
			if (!$rights->can->modify) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:623: characters 5-10
				throw new HxException("Can't modify");
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:624: lines 624-629
			if (array_key_exists("__upload", $params->data)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:625: characters 5-53
				$this->request($table, $table->updateFields($inst, $binaries));
			} else {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:627: characters 5-18
				$inst->update();
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:628: characters 5-58
				Admin::log("Updated " . ($table->name??'null') . " " . ($table->identifier($inst)??'null'));
			}
		} catch (\Throwable $__hx__caught_e) {
			CallStack::saveExceptionTrace($__hx__caught_e);
			$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
			$e = $__hx__real_e;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:631: characters 4-44
			$this->edit($table, $id, $params, null, \Std::string($e));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:632: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:634: characters 3-66
		$this->style->redirect(($table->className??'null') . "/edit/" . ($table->identifier($inst)??'null'));
	}

	/**
	 * insert a new object in a table
	 * 
	 * @param TableInfos $table
	 * @param StringMap $params
	 * 
	 * @return void
	 */
	public function doInsert ($table, $params) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:469: characters 3-36
		$inst = $this->createInstance($table);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:470: characters 3-29
		$this->updateParams($table, $params);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:471: characters 13-25
		$_g_head = $table->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:471: lines 471-492
		while ($_g_head !== null) {
			$val = $_g_head->item;
			$_g_head = $_g_head->next;
			$f = $val;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:472: characters 4-31
			$v = ($params->data[$f->name] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:473: lines 473-483
			if ($v === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:474: lines 474-481
				if (array_key_exists($f->name, $table->nulls->data)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:475: characters 6-40
					\Reflect::setField($inst, $f->name, null);
				} else {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:477: lines 477-481
					$_g = 0;
					$_g1 = $table->relations;
					while ($_g < $_g1->length) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:477: characters 11-12
						$r = ($_g1->arr[$_g] ?? null);
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:477: lines 477-481
						++$_g;
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:478: lines 478-481
						if ($f->name === $r->key) {
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:479: characters 8-35
							$this->insert($table, $params, $f->name);
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:480: characters 8-14
							return;
						}
					}
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:482: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:484: characters 4-19
			$msg = null;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:485: characters 4-97
			$v1 = null;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:485: characters 12-96
			try {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:485: characters 4-97
				$v1 = $this->updateField($f->name, $v, $f->type, $table);
			} catch (\Throwable $__hx__caught_e) {
				CallStack::saveExceptionTrace($__hx__caught_e);
				$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
				if (is_string($__hx__real_e)) {
					$err = $__hx__real_e;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:485: characters 78-81
					$msg = $err;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:485: characters 4-97
					$v1 = null;
				} else  throw $__hx__caught_e;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:486: lines 486-490
			if ($v1 === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:488: characters 5-36
				$this->insert($table, $params, $f->name, $msg);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:489: characters 5-11
				return;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:491: characters 4-35
			\Reflect::setField($inst, $f->name, $v1);
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:493: lines 493-494
		if (($table->primary->length === 1) && Boot::equal(\Reflect::field($inst, $table->primary->first()), 0)) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:494: characters 4-51
			\Reflect::deleteField($inst, $table->primary->first());
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:495: lines 495-505
		try {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:496: lines 496-497
			if (!$this->getRights($inst)->can->insert) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:497: characters 5-10
				throw new HxException("Can't insert");
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:498: lines 498-499
			if ($inst === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:499: characters 5-10
				throw new HxException("instance is null");
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:500: characters 4-17
			$inst->insert();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:501: characters 4-58
			Admin::log("Inserted " . ($table->name??'null') . " " . ($table->identifier($inst)??'null'));
		} catch (\Throwable $__hx__caught_e) {
			CallStack::saveExceptionTrace($__hx__caught_e);
			$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
			$e = $__hx__real_e;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:503: characters 4-43
			$this->insert($table, $params, null, \Std::string($e));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:504: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:508: lines 508-511
		if (array_key_exists("__new", $params->data)) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:509: characters 4-24
			$this->insert($table, $params);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:510: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:512: characters 3-66
		$this->style->redirect(($table->className??'null') . "/edit/" . ($table->identifier($inst)??'null'));
	}

	/**
	 * @param StringMap $params
	 * 
	 * @return void
	 */
	public function doSync ($params) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:900: characters 3-95
		$order = \Array_hx::wrap([
			"create",
			"add",
			"reldel",
			"idxdel",
			"update",
			"remove",
			"rename",
			"idxadd",
			"reladd",
		]);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:901: characters 3-25
		$cmd = new \Array_hx();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:902: characters 13-26
		$p = new NativeIndexedArrayIterator(array_map("strval", array_keys($params->data)));
		while ($p->hasNext()) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:902: lines 902-906
			$p1 = $p->next();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:903: lines 903-904
			if (!(new \EReg("[A-Za-z0-9_@]*", ""))->match($p1)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:904: characters 5-10
				throw new HxException("Invalid command " . ($p1??'null'));
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:905: characters 4-26
			$cmd->arr[$cmd->length] = HxString::split($p1, "@");
			++$cmd->length;

		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:907: lines 907-915
		usort($cmd->arr, function ($c1, $c2)  use (&$order) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:908: characters 4-23
			$p11 = 0;
			$p2 = 0;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:909: lines 909-913
			$_g = 0;
			$_g1 = $order->length;
			while ($_g < $_g1) {
				$i = $_g++;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:910: lines 910-913
				if (($order->arr[$i] ?? null) === ($c1->arr[1] ?? null)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:911: characters 6-12
					$p11 = $i;
				} else if (($order->arr[$i] ?? null) === ($c2->arr[1] ?? null)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:913: characters 6-12
					$p2 = $i;
				}
			}

			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:914: characters 4-18
			return $p11 - $p2;
		});
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:916: lines 916-952
		$_g2 = 0;
		while ($_g2 < $cmd->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:916: characters 8-12
			$data = ($cmd->arr[$_g2] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:916: lines 916-952
			++$_g2;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:917: characters 16-28
			if ($data->length > 0) {
				$data->length--;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:917: characters 4-29
			$tname = array_shift($data->arr);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:920: characters 4-38
			$tname = HxString::split($tname, "_")->join(".");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:922: characters 4-38
			$table = new TableInfos($tname);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:923: characters 14-26
			if ($data->length > 0) {
				$data->length--;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:923: characters 4-27
			$act = array_shift($data->arr);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:924: characters 16-28
			if ($data->length > 0) {
				$data->length--;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:924: characters 4-29
			$field = array_shift($data->arr);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:925: lines 925-951
			try {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:926: lines 926-947
				if ($act === null) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:946: characters 6-11
					throw new HxException("Unknown action " . ($act??'null'));
				} else {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:926: characters 13-16
					if ($act === "add") {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:930: characters 6-43
						$this->execute($table->addFieldRequest($field));
					} else if ($act === "create") {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:928: characters 6-41
						$this->execute($table->createRequest(false));
					} else if ($act === "idxadd") {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:942: characters 6-58
						$this->execute($table->addIndexRequest($data, $field === "true"));
					} else if ($act === "idxdel") {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:944: characters 6-46
						$this->execute($table->deleteIndexRequest($field));
					} else if ($act === "reladd") {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:938: characters 45-57
						if ($data->length > 0) {
							$data->length--;
						}
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:938: characters 6-59
						$this->execute($table->addRelationRequest($field, array_shift($data->arr)));
					} else if ($act === "reldel") {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:940: characters 6-49
						$this->execute($table->deleteRelationRequest($field));
					} else if ($act === "remove") {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:934: characters 6-46
						$this->execute($table->removeFieldRequest($field));
					} else if ($act === "rename") {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:936: characters 45-57
						if ($data->length > 0) {
							$data->length--;
						}
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:936: characters 6-59
						$this->execute($table->renameFieldRequest($field, array_shift($data->arr)));
					} else if ($act === "update") {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:932: characters 6-46
						$this->execute($table->updateFieldRequest($field));
					} else {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:946: characters 6-11
						throw new HxException("Unknown action " . ($act??'null'));
					}
				}
			} catch (\Throwable $__hx__caught_e) {
				CallStack::saveExceptionTrace($__hx__caught_e);
				$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
				$e = $__hx__real_e;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:949: characters 5-25
				$this->index(\Std::string($e));
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:950: characters 5-11
				return;
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:953: characters 3-21
		$this->style->redirect("");
	}

	/**
	 * @param TableInfos $table
	 * @param string $id
	 * @param StringMap $params
	 * @param string $error
	 * @param string $errorMsg
	 * 
	 * @return void
	 */
	public function edit ($table, $id, $params = null, $error = null, $errorMsg = null) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:539: characters 3-38
		$obj = $table->fromIdentifier($id);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:540: characters 3-64
		$objStr = null;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:540: characters 16-63
		try {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:540: characters 3-64
			$objStr = \Std::string($obj);
		} catch (\Throwable $__hx__caught_e) {
			CallStack::saveExceptionTrace($__hx__caught_e);
			$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
			$e = $__hx__real_e;
			$objStr = "#" . ($id??'null');
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:541: characters 3-45
		$this->style->begin("Edit " . ($table->name??'null') . " " . ($objStr??'null'));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:542: lines 542-546
		if ($obj === null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:543: characters 4-46
			$this->style->error("This object does not exists");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:544: characters 4-15
			$this->style->end();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:545: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:547: characters 3-22
		$binary = false;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:548: characters 13-25
		$_g_head = $table->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:548: lines 548-552
		while ($_g_head !== null) {
			$val = $_g_head->item;
			$_g_head = $_g_head->next;
			$f = $val;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:549: lines 549-552
			if ($this->isBinary($f->type)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:550: characters 5-11
				$binary = true;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:551: characters 5-10
				break;
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:553: characters 3-67
		$this->style->beginForm(($table->className??'null') . "/doEdit/" . ($id??'null'), $binary, $table->name);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:554: characters 3-31
		$rights = $this->getRights($obj);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:555: characters 3-25
		$hasBinary = false;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:556: characters 13-25
		$_g1_head = $table->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:556: lines 556-567
		while ($_g1_head !== null) {
			$val1 = $_g1_head->item;
			$_g1_head = $_g1_head->next;
			$f1 = $val1;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:557: lines 557-560
			if ($f1->name === $error) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:558: characters 5-71
				$this->style->errorField(($errorMsg === null ? "Invalid format" : $errorMsg));
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:559: characters 5-13
				$errorMsg = null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:561: lines 561-562
			if ($this->has($rights->invisible, $f1->name)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:562: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:563: characters 4-47
			$readonly = $this->has($rights->readOnly, $f1->name);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:564: characters 4-122
			$this->inputField($table, $f1, $id, $readonly, ($params === null ? \Reflect::field($obj, $f1->name) : ($params->data[$f1->name] ?? null)), $params !== null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:565: lines 565-566
			if (!$readonly && $this->isBinary($f1->type)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:566: characters 5-14
				$hasBinary = true;
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:568: lines 568-572
		if ($rights->can->modify) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:569: characters 4-29
			$this->style->addSubmit("Modify");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:570: lines 570-571
			if ($hasBinary) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:571: characters 5-51
				$this->style->addSubmit("Upload", null, null, "__upload");
			}
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:573: characters 3-56
		$this->style->addSubmit("Cancel", ($table->className??'null') . "/edit/" . ($id??'null'));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:574: lines 574-575
		if ($rights->can->delete) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:575: characters 4-66
			$this->style->addSubmit("Delete", ($table->className??'null') . "/doDelete/" . ($id??'null'), true);
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:576: characters 3-18
		$this->style->endForm();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:577: lines 577-578
		if ($errorMsg !== null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:578: characters 4-25
			$this->style->error($errorMsg);
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:579: characters 3-14
		$this->style->end();
	}

	/**
	 * @param string $sql
	 * 
	 * @return ResultSet
	 */
	public function execute ($sql) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:68: characters 3-34
		return Manager::$cnx->request($sql);
	}

	/**
	 * @param Object_hx $t
	 * @param TableInfos $table
	 * 
	 * @return object
	 */
	public function getRights ($t = null, $table = null) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:443: characters 3-24
		return $this->default_rights;
	}

	/**
	 * @param Object_hx $t
	 * 
	 * @return object
	 */
	public function getSearchInfos ($t) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:458: characters 3-14
		return null;
	}

	/**
	 * Get table infos from SPOD classes
	 * 
	 * @return \Array_hx
	 */
	public function getTables () {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:88: characters 3-28
		$tables = new \Array_hx();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:89: characters 3-34
		$classes = Lib::getClasses();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:90: characters 3-25
		$this->crawl($tables, $classes);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:91: characters 3-108
		usort($tables->arr, function ($t1, $t2) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:91: characters 40-104
			if (strcmp($t1->name, $t2->name) > 0) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:91: characters 64-65
				return 1;
			} else if (strcmp($t1->name, $t2->name) < 0) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:91: characters 95-97
				return -1;
			} else {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:91: characters 103-104
				return 0;
			}
		});
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:92: characters 3-16
		return $tables;
	}

	/**
	 * @param object $a
	 * @param mixed $v
	 * 
	 * @return bool
	 */
	public function has ($a, $v) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:96: characters 13-25
		$x = $a->iterator();
		while ($x->hasNext()) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:96: lines 96-98
			$x1 = $x->next();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:97: lines 97-98
			if (Boot::equal($x1, $v)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:98: characters 5-16
				return true;
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:99: characters 3-15
		return false;
	}

	/**
	 * Index page : List tables
	 * 
	 * @param string $errorMsg
	 * 
	 * @return void
	 */
	public function index ($errorMsg = null) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:134: characters 3-24
		$this->style->begin("Tables");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:135: characters 3-28
		$this->style->beginForm("doSync");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:136: characters 3-21
		$this->style->beginTable();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:137: characters 3-20
		$sync = false;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:140: characters 3-38
		$allTables = new List_hx();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:141: characters 3-57
		$resulSet = $this->execute(TableInfos::allTablesRequest());
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:142: characters 13-21
		$r = $resulSet;
		while ($r->hasNext()) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:142: lines 142-146
			$r1 = $r->next();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:143: characters 4-36
			$res = $r1->Tables_in_db;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:144: characters 4-30
			if ($res === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:144: characters 22-30
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:145: characters 4-22
			$allTables->add($res);
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:149: characters 3-47
		$windows = \Sys::systemName() === "Windows";
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:150: lines 150-175
		$_g = 0;
		$_g1 = $this->getTables();
		while ($_g < $_g1->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:150: characters 8-9
			$t = ($_g1->arr[$_g] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:150: lines 150-175
			++$_g;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:151: characters 4-46
			$rights = $this->getRights($this->createInstance($t));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:152: characters 4-25
			$this->style->beginLine(true);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:153: characters 4-22
			$this->style->text($t->name);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:154: characters 4-19
			$this->style->nextRow();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:155: lines 155-171
			if (!$this->boolResult($t->existsRequest())) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:156: characters 5-56
				$this->style->linkConfirm(($t->className??'null') . "/doCreate", "create");
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:157: characters 5-37
				$this->style->text("Table is Missing !");
			} else {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:159: lines 159-160
				if ($this->needSync($t)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:160: characters 6-10
					$sync = true;
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:161: lines 161-162
				if ($rights->can->insert) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:162: characters 6-48
					$this->style->link(($t->className??'null') . "/insert", "insert");
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:163: characters 5-20
				$this->style->nextRow();
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:164: characters 5-47
				$this->style->link(($t->className??'null') . "/search", "search");
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:165: lines 165-166
				if ($rights->can->truncate) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:166: characters 6-59
					$this->style->linkConfirm(($t->className??'null') . "/doCleanup", "cleanup");
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:167: lines 167-170
				if ($this->allowDrop) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:168: characters 6-21
					$this->style->nextRow();
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:169: characters 6-53
					$this->style->linkConfirm(($t->className??'null') . "/doDrop", "drop");
				}
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:172: characters 4-19
			$this->style->endLine();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:173: characters 4-28
			$allTables->remove($t->name);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:174: characters 4-81
			if ($windows || TableInfos::$OLD_COMPAT) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:174: characters 43-81
				$allTables->remove(mb_strtolower($t->name));
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:176: characters 3-19
		$this->style->endTable();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:177: lines 177-178
		if ($sync) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:178: characters 4-48
			$this->style->addSubmit("Synchronize Database", null, true);
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:179: characters 3-18
		$this->style->endForm();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:180: lines 180-188
		if (!$allTables->isEmpty()) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:181: characters 4-21
			$this->style->beginList();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:182: characters 14-23
			$_g2_head = $allTables->h;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:182: lines 182-186
			while ($_g2_head !== null) {
				$val = $_g2_head->item;
				$_g2_head = $_g2_head->next;
				$t1 = $val;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:183: characters 5-22
				$this->style->beginItem();
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:184: characters 5-77
				$this->style->text("Table \"" . (\Std::string($t1)??'null') . "\" does not have any matching object");
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:185: characters 5-20
				$this->style->endItem();
			}

			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:187: characters 4-19
			$this->style->endList();
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:189: lines 189-190
		if ($errorMsg !== null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:190: characters 4-25
			$this->style->error($errorMsg);
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:191: characters 3-14
		$this->style->end();
	}

	/**
	 * @param object $i
	 * 
	 * @return string
	 */
	public function indexId ($i) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:957: characters 3-39
		return (\Std::string($i->unique)??'null') . "@" . ($i->keys->join("@")??'null');
	}

	/**
	 * @param TableInfos $table
	 * @param object $f
	 * @param string $id
	 * @param bool $readonly
	 * @param mixed $defval
	 * @param bool $rawValue
	 * 
	 * @return void
	 */
	public function inputField ($table, $f, $id, $readonly, $defval = null, $rawValue = null) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:211: characters 3-40
		$prim = $this->has($table->primary, $f->name);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:212: characters 3-29
		$insert = $id === null;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:213: lines 213-233
		$_g = 0;
		$_g1 = $table->relations;
		while ($_g < $_g1->length) {
			unset($r);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:213: characters 8-9
			$r = ($_g1->arr[$_g] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:213: lines 213-233
			++$_g;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:214: lines 214-233
			if ($r->key === $f->name) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:215: characters 5-23
				$values = null;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:216: lines 216-222
				if ($this->canDisplay($r->manager) || ($r->className === "db.File")) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:217: lines 217-222
					$values = $r->manager->all(false)->map(function ($d)  use (&$r) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:219: characters 13-65
						$values1 = \Std::string(\Reflect::field($d, ($r->manager->table_keys->arr[0] ?? null)));
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:218: lines 218-221
						return new HxAnon([
							"id" => $values1,
							"str" => $d->toString(),
						]);
					});
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:223: characters 5-88
				$cname = (mb_substr($r->className, 0, 3) === "db." ? mb_substr($r->className, 3, null) : $r->className);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:224: lines 224-231
				$this->style->choiceField($r->prop, $values, \Std::string($defval), ($cname??'null') . "/edit/", !$insert && ($prim || $readonly), $r->className === "db.File");
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:232: characters 5-11
				return;
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:234: lines 234-258
		if (($defval !== null) && !$rawValue) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:235: characters 12-18
			$__hx__switch = ($f->type->index);
			if ($__hx__switch === 20) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:237: characters 5-46
				$defval = \Std::parseInt(\Std::string($defval));
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:238: characters 5-31
				$defval = Id::decode($defval);
			} else if ($__hx__switch === 21) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:240: characters 5-45
				$defval = (new Serialized($defval))->escape();
			} else if ($__hx__switch === 22) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:247: characters 5-10
				throw new HxException("DNekoSerialized is only available on neko target");
			} else if ($__hx__switch === 30) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:251: characters 6-145
				$str = null;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:251: characters 16-144
				try {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:251: characters 6-145
					$str = Serializer::run($table->manager->doUnserialize($f->name, $defval));
				} catch (\Throwable $__hx__caught_e) {
					CallStack::saveExceptionTrace($__hx__caught_e);
					$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
					$e = $__hx__real_e;
					$str = "ERROR : " . (\Std::string($e)??'null');
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:255: characters 5-42
				$defval = (new Serialized($str))->escape();
			} else {
			}
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:259: lines 259-266
		if ($this->isBinary($f->type)) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:260: characters 4-146
			$this->style->binField($f->name, array_key_exists($f->name, $table->nulls->data), $defval, ($insert ? null : function ()  use (&$table, &$f, &$id) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:260: characters 96-142
				return ($table->name??'null') . "/doDownload/" . ($id??'null') . "/" . ($f->name??'null');
			}));
		} else if ($insert && $readonly) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:262: characters 4-10
			return;
		} else if (!$insert && ($prim || $readonly)) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:264: characters 4-34
			$this->style->infoField($f->name, $defval);
		} else {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:266: characters 4-69
			$this->style->inputField($f->name, $f->type, array_key_exists($f->name, $table->nulls->data), $defval);
		}
	}

	/**
	 * Prints an insert form
	 * 
	 * @param TableInfos $table
	 * @param StringMap $params
	 * @param string $error
	 * @param string $errorMsg
	 * 
	 * @return void
	 */
	public function insert ($table, $params = null, $error = null, $errorMsg = null) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:273: characters 3-22
		$binary = false;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:274: characters 13-25
		$_g_head = $table->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:274: lines 274-278
		while ($_g_head !== null) {
			$val = $_g_head->item;
			$_g_head = $_g_head->next;
			$f = $val;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:275: lines 275-278
			if ($this->isBinary($f->type)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:276: characters 5-11
				$binary = true;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:277: characters 5-10
				break;
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:279: characters 3-40
		$this->style->begin("Insert new " . ($table->name??'null'));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:280: characters 3-65
		$this->style->beginForm(($table->className??'null') . "/doInsert", $binary, $table->name);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:281: characters 3-33
		$rights = $this->getRights(null, $table);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:282: characters 13-25
		$_g1_head = $table->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:282: lines 282-291
		while ($_g1_head !== null) {
			$val1 = $_g1_head->item;
			$_g1_head = $_g1_head->next;
			$f1 = $val1;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:283: lines 283-286
			if ($f1->name === $error) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:284: characters 5-71
				$this->style->errorField(($errorMsg === null ? "Invalid format" : $errorMsg));
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:285: characters 5-13
				$errorMsg = null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:287: lines 287-288
			if ($this->has($rights->invisible, $f1->name)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:288: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:289: characters 4-47
			$readonly = $this->has($rights->readOnly, $f1->name);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:290: characters 4-104
			$this->inputField($table, $f1, null, $readonly, ($params === null ? null : ($params->data[$f1->name] ?? null)), $params !== null);
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:292: characters 3-28
		$this->style->addSubmit("Insert");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:293: characters 3-51
		$this->style->addSubmit("Insert New", null, false, "__new");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:294: characters 3-18
		$this->style->endForm();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:295: lines 295-296
		if ($errorMsg !== null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:296: characters 4-25
			$this->style->error($errorMsg);
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:297: characters 3-14
		$this->style->end();
	}

	/**
	 * @param RecordType $t
	 * 
	 * @return bool
	 */
	public function isBinary ($t) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:195: lines 195-198
		$__hx__switch = ($t->index);
		if ($__hx__switch === 16 || $__hx__switch === 17 || $__hx__switch === 18 || $__hx__switch === 19) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:196: characters 55-59
			return true;
		} else {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:197: characters 12-17
			return false;
		}
	}

	/**
	 * check for differences between classes and tables in DB
	 * 
	 * @param TableInfos $t
	 * 
	 * @return bool
	 */
	public function needSync ($t) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:964: characters 3-59
		$desc = $this->execute($t->descriptionRequest())->getResult(1);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:965: characters 3-46
		$inf = TableInfos::fromDescription($desc);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:966: characters 17-26
		$this1 = [];
		$renames_data = $this1;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:967: characters 3-16
		$this->hasSyncAction = false;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:970: characters 13-21
		$_g_head = $t->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:970: lines 970-1004
		while ($_g_head !== null) {
			$val = $_g_head->item;
			$_g_head = $_g_head->next;
			$f = $val;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:971: characters 4-36
			$t2 = ($inf->fields->data[$f->name] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:972: lines 972-1003
			if ($t2 === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:973: characters 5-24
				$rename = false;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:974: characters 15-32
				$n = new NativeIndexedArrayIterator(array_map("strval", array_keys($inf->fields->data)));
				while ($n->hasNext()) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:974: lines 974-980
					$n1 = $n->next();
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:975: lines 975-980
					if (!array_key_exists($n1, $t->hfields->data) && \Type::enumEq(($inf->fields->data[$n1] ?? null), $f->type) && (($inf->nulls->data[$n1] ?? null) === ($t->nulls->data[$f->name] ?? null))) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:976: characters 7-13
						$rename = true;
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:977: characters 7-26
						$renames_data[$n1] = true;
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:978: characters 7-75
						$this->syncAction($t, \Array_hx::wrap([
							"rename",
							$n1,
							$f->name,
						]), "Rename field \"" . ($n1??'null') . "\" to \"" . ($f->name??'null') . "\"");
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:979: characters 7-12
						break;
					}
				}

				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:981: characters 5-61
				$this->syncAction($t, \Array_hx::wrap([
					"add",
					$f->name,
				]), "Add field " . ($f->name??'null'), !$rename);
			} else {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:983: characters 5-30
				$inf->fields->remove($f->name);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:984: characters 5-40
				$isnull = ($inf->nulls->data[$f->name] ?? null);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:985: characters 5-25
				$changed = false;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:986: characters 5-38
				$txt = "Change " . ($f->name??'null') . " : ";
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:987: lines 987-990
				if (!\Type::enumEq($f->type, $t2) && !TableInfos::sameDBStorage($t2, $f->type)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:988: characters 6-13
					$changed = true;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:989: characters 6-84
					$txt = ($txt??'null') . " S" . (mb_substr(\Std::string($t2), 1, null)??'null') . " becomes S" . (mb_substr(\Std::string($f->type), 1, null)??'null');
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:991: lines 991-1000
				if ($isnull !== ($t->nulls->data[$f->name] ?? null)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:992: lines 992-995
					if ($changed) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:993: characters 7-20
						$txt = ($txt??'null') . " and";
					} else {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:995: characters 7-14
						$changed = true;
					}
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:996: lines 996-999
					if ($isnull) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:997: characters 7-30
						$txt = ($txt??'null') . " can't be NULL";
					} else {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:999: characters 7-28
						$txt = ($txt??'null') . " can be NULL";
					}
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1001: lines 1001-1002
				if ($changed) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1002: characters 6-41
					$this->syncAction($t, \Array_hx::wrap([
						"update",
						$f->name,
					]), $txt);
				}
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1006: characters 13-30
		$f1 = new NativeIndexedArrayIterator(array_map("strval", array_keys($inf->fields->data)));
		while ($f1->hasNext()) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1006: lines 1006-1007
			$f2 = $f1->next();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1007: characters 4-67
			$this->syncAction($t, \Array_hx::wrap([
				"remove",
				$f2,
			]), "Remove field " . ($f2??'null'), !array_key_exists($f2, $renames_data));
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1009: lines 1009-1030
		$_g1 = 0;
		$_g2 = $t->relations;
		while ($_g1 < $_g2->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1009: characters 8-9
			$r = ($_g2->arr[$_g1] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1009: lines 1009-1030
			++$_g1;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1010: lines 1010-1011
			if (!$t->isRelationActive($r)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1011: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1012: characters 4-58
			$tname = TableInfos::unescape($r->manager->table_name);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1013: characters 4-22
			$found = false;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1014: characters 4-37
			$setnull = ($t->nulls->data[$r->key] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1015: lines 1015-1016
			if ($setnull && ($r->cascade === true)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1016: characters 5-12
				$setnull = null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1017: lines 1017-1027
			$_g11 = 0;
			$_g21 = $inf->relations;
			while ($_g11 < $_g21->length) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1017: characters 9-11
				$r2 = ($_g21->arr[$_g11] ?? null);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1017: lines 1017-1027
				++$_g11;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1018: lines 1018-1027
				if ((((($t->name??'null') . "_" . ($r->prop??'null')) === $r2->name) || TableInfos::$OLD_COMPAT) && ($r->key === $r2->key) && (mb_strtolower($tname) === mb_strtolower($r2->table)) && ($r->manager->table_keys->length === 1) && (($r->manager->table_keys->arr[0] ?? null) === $r2->id) && ($r2->setnull === $setnull)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1024: characters 6-11
					$found = true;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1025: characters 6-30
					$inf->relations->remove($r2);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1026: characters 6-11
					break;
				}
			}

			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1028: lines 1028-1029
			if (!$found) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1029: characters 5-155
				$this->syncAction($t, \Array_hx::wrap([
					"reladd",
					$r->key,
					$r->prop,
				]), "Add Relation " . ($r->prop??'null') . "(" . ($r->key??'null') . ") on " . ($tname??'null') . "(" . (($r->manager->table_keys->arr[0] ?? null)??'null') . ")" . ((($setnull ? " set-null" : ""))??'null'));
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1032: lines 1032-1033
		$_g3 = 0;
		$_g4 = $inf->relations;
		while ($_g3 < $_g4->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1032: characters 8-9
			$r1 = ($_g4->arr[$_g3] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1032: lines 1032-1033
			++$_g3;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1033: characters 4-136
			$this->syncAction($t, \Array_hx::wrap([
				"reldel",
				$r1->name,
			]), "Remove Relation " . ($r1->name??'null') . "(" . ($r1->key??'null') . ") on " . ($r1->table??'null') . "(" . ($r1->id??'null') . ")" . ((($r1->setnull ? " set-null" : ""))??'null'));
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1035: characters 3-24
		$hidx = new StringMap();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1036: characters 13-22
		$_g5_head = $t->indexes->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1036: lines 1036-1037
		while ($_g5_head !== null) {
			$val1 = $_g5_head->item;
			$_g5_head = $_g5_head->next;
			$i = $val1;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1037: characters 4-26
			$key = $this->indexId($i);
			$hidx->data[$key] = $i;

		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1038: characters 3-25
		$used = new List_hx();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1039: lines 1039-1061
		$_g6 = 0;
		$_g7 = $t->relations;
		while ($_g6 < $_g7->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1039: characters 8-9
			$r3 = ($_g7->arr[$_g6] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1039: lines 1039-1061
			++$_g6;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1040: characters 4-62
			$found1 = null;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1041: characters 14-23
			$_g6_head = $t->indexes->h;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1041: lines 1041-1043
			while ($_g6_head !== null) {
				$val2 = $_g6_head->item;
				$_g6_head = $_g6_head->next;
				$i1 = $val2;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1042: lines 1042-1043
				if (($i1->keys->first() === $r3->key) && (($found1 === null) || ($found1->keys->length < $i1->keys->length))) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1043: characters 6-11
					$found1 = $i1;
				}
			}

			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1044: lines 1044-1050
			if ($found1 === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1046: lines 1046-1047
				if ($t->primary->first() === $r3->key) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1047: characters 6-14
					continue;
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1049: characters 5-10
				$found1 = new HxAnon([
					"keys" => \Lambda::list(\Array_hx::wrap([$r3->key])),
					"unique" => false,
				]);
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1051: characters 4-31
			$hidx->remove($this->indexId($found1));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1052: characters 14-25
			$i2 = new NativeIndexedArrayIterator(array_values($inf->indexes->data));
			while ($i2->hasNext()) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1052: lines 1052-1057
				$i3 = $i2->next();
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1053: lines 1053-1057
				if (($i3->keys->join("#") === $found1->keys->join("#")) && ($i3->unique === $found1->unique)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1054: characters 6-17
					$used->add($i3);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1055: characters 6-11
					$found1 = null;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1056: characters 6-11
					break;
				}
			}

			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1059: lines 1059-1060
			if ($found1 !== null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1060: characters 5-35
				$key1 = $this->indexId($found1);
				$hidx->data[$key1] = $found1;
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1062: characters 13-17
		$_g8_head = $used->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1062: lines 1062-1063
		while ($_g8_head !== null) {
			$val3 = $_g8_head->item;
			$_g8_head = $_g8_head->next;
			$i4 = $val3;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1063: characters 4-30
			$inf->indexes->remove($i4->name);
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1064: characters 17-35
		$iname = new NativeIndexedArrayIterator(array_map("strval", array_keys($inf->indexes->data)));
		while ($iname->hasNext()) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1064: lines 1064-1068
			$iname1 = $iname->next();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1065: characters 4-35
			$i5 = ($inf->indexes->data[$iname1] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1066: lines 1066-1067
			if (!$hidx->remove($this->indexId($i5))) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1067: characters 5-121
				$this->syncAction($t, \Array_hx::wrap([
					"idxdel",
					$iname1,
				]), "Remove " . ((($i5->unique ? "Unique " : ""))??'null') . "Index " . ($iname1??'null') . " (" . ($i5->keys->join(",")??'null') . ")");
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1069: characters 13-17
		$i6 = new NativeIndexedArrayIterator(array_values($hidx->data));
		while ($i6->hasNext()) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1069: lines 1069-1070
			$i7 = $i6->next();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1070: characters 4-112
			$this->syncAction($t, \Array_hx::wrap([
				"idxadd",
				$this->indexId($i7),
			]), "Add " . ((($i7->unique ? "Unique " : ""))??'null') . "Index (" . ($i7->keys->join(",")??'null') . ")");
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1072: lines 1072-1075
		if ((($inf->primary === null) !== ($t->primary === null)) || (($inf->primary !== null) && ($inf->primary->join("-") !== $t->primary->join("-")))) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1073: characters 4-39
			$this->style->text("PRIMARY KEY CHANGED !");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1074: characters 4-17
			$this->hasSyncAction = true;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1076: lines 1076-1077
		if ($this->hasSyncAction) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1077: characters 4-19
			$this->style->endList();
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1078: characters 3-23
		return $this->hasSyncAction;
	}

	/**
	 * @param \Array_hx $url
	 * 
	 * @return void
	 */
	public function process ($url = null) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1082: lines 1082-1088
		if ($url === null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1083: characters 4-33
			$url = HxString::split(Web::getURI(), "/");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1084: characters 4-15
			if ($url->length > 0) {
				$url->length--;
			}
			array_shift($url->arr);

			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1085: characters 4-15
			if ($url->length > 0) {
				$url->length--;
			}
			array_shift($url->arr);

			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1086: lines 1086-1087
			if (($url->arr[0] ?? null) === "index.n") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1087: characters 5-16
				if ($url->length > 0) {
					$url->length--;
				}
				array_shift($url->arr);
			}
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1089: characters 3-37
		if ($url->length === 0) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1089: characters 25-37
			$url->arr[$url->length] = "";
			++$url->length;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1090: characters 3-32
		$params = Web::getParams();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1091: characters 11-17
		$__hx__switch = (($url->arr[0] ?? null));
		if ($__hx__switch === "") {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1094: characters 4-32
			$this->style = new AdminStyle(null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1095: characters 4-11
			$this->index();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1096: characters 4-10
			return;
		} else if ($__hx__switch === "doSync") {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1099: characters 4-32
			$this->style = new AdminStyle(null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1100: characters 4-18
			$this->doSync($params);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1101: characters 4-10
			return;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1103: characters 30-41
		if ($url->length > 0) {
			$url->length--;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1103: characters 3-43
		$table = new TableInfos(array_shift($url->arr));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1104: characters 3-32
		$this->style = new AdminStyle($table);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1105: characters 13-24
		if ($url->length > 0) {
			$url->length--;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1105: characters 3-25
		$act = array_shift($url->arr);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1106: lines 1106-1129
		if ($act === null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1128: characters 4-9
			throw new HxException("Unknown action " . ($act??'null'));
		} else {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1106: characters 11-14
			if ($act === "doCleanup") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1120: characters 4-20
				$this->doCleanup($table);
			} else if ($act === "doCreate") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1116: characters 4-19
				$this->doCreate($table);
			} else if ($act === "doDelete") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1122: characters 4-33
				$this->doDelete($table, $url->join("/"));
			} else if ($act === "doDownload") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1124: characters 21-32
				if ($url->length > 0) {
					$url->length--;
				}
				$tmp = array_shift($url->arr);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1124: characters 33-44
				if ($url->length > 0) {
					$url->length--;
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1124: characters 4-45
				$this->doDownload($table, $tmp, array_shift($url->arr));
			} else if ($act === "doDrop") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1118: characters 4-17
				$this->doDrop($table);
			} else if ($act === "doEdit") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1114: characters 4-38
				$this->doEdit($table, $url->join("/"), $params);
			} else if ($act === "doInsert") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1110: characters 4-26
				$this->doInsert($table, $params);
			} else if ($act === "edit") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1112: characters 4-29
				$this->edit($table, $url->join("/"));
			} else if ($act === "insert") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1108: characters 4-24
				$this->insert($table, $params);
			} else if ($act === "search") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1126: characters 4-24
				$this->search($table, $params);
			} else {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:1128: characters 4-9
				throw new HxException("Unknown action " . ($act??'null'));
			}
		}
	}

	/**
	 * @param TableInfos $t
	 * @param string $sql
	 * 
	 * @return ResultSet
	 */
	public function request ($t, $sql) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:72: characters 3-34
		return Manager::$cnx->request($sql);
	}

	/**
	 * Search a table
	 * 
	 * @param TableInfos $table
	 * @param StringMap $params
	 * 
	 * @return void
	 */
	public function search ($table, $params) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:719: characters 3-36
		$this->style->begin("Search " . ($table->name??'null'));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:721: characters 3-21
		$pagesize = 30;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:722: characters 3-46
		$page = \Std::parseInt(($params->data["__p"] ?? null));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:723: characters 3-33
		$order = ($params->data["__o"] ?? null);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:724: lines 724-725
		if ($page === null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:725: characters 4-8
			$page = 0;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:726: characters 3-23
		$params->remove("__p");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:727: characters 3-23
		$params->remove("__o");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:730: characters 3-22
		$paramsStr = "";
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:731: characters 13-26
		$p = new NativeIndexedArrayIterator(array_map("strval", array_keys($params->data)));
		while ($p->hasNext()) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:731: lines 731-734
			$p1 = $p->next();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:732: characters 4-26
			$v = ($params->data[$p1] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:733: characters 4-51
			$paramsStr = ($paramsStr??'null') . ($p1??'null') . "=" . (rawurlencode($v)??'null') . ";";
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:737: characters 13-25
		$_g_head = $table->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:737: lines 737-742
		while ($_g_head !== null) {
			$val = $_g_head->item;
			$_g_head = $_g_head->next;
			$f = $val;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:738: characters 12-18
			$__hx__switch = ($f->type->index);
			if ($__hx__switch === 8 || $__hx__switch === 9 || $__hx__switch === 13 || $__hx__switch === 14 || $__hx__switch === 15 || $__hx__switch === 23) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:740: characters 5-33
				$table->nulls->data[$f->name] = true;
			} else {
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:744: characters 3-29
		$this->updateParams($table, $params);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:747: characters 13-25
		$_g1_head = $table->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:747: lines 747-749
		while ($_g1_head !== null) {
			$val1 = $_g1_head->item;
			$_g1_head = $_g1_head->next;
			$f1 = $val1;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:748: lines 748-749
			if (!array_key_exists($f1->name, $table->nulls->data) && (($params->data[$f1->name] ?? null) === "")) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:749: characters 5-26
				$params->remove($f1->name);
			}
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:751: characters 3-33
		$rights = $this->getRights(null, $table);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:752: lines 752-753
		$_g2 = 0;
		$_g3 = $rights->invisible;
		while ($_g2 < $_g3->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:752: characters 8-9
			$f2 = ($_g3->arr[$_g2] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:752: lines 752-753
			++$_g2;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:753: characters 4-20
			$params->remove($f2);
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:755: characters 3-73
		$results = $table->fromSearch($params, $order, $page * $pagesize, $pagesize + 1);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:756: characters 3-23
		$hasNext = false;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:757: lines 757-760
		if ($results->length > $pagesize) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:758: characters 4-34
			$results->remove($results->last());
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:759: characters 4-11
			$hasNext = true;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:762: characters 3-68
		$sinfos = $this->getSearchInfos($this->createInstance($table));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:763: characters 3-14
		$fields = null;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:764: lines 764-779
		if (($sinfos !== null) && ($sinfos->fields !== null)) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:765: characters 4-10
			$fields = $sinfos->fields;
		} else {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:767: characters 4-10
			$fields = new \Array_hx();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:768: characters 14-26
			$_g4_head = $table->fields->h;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:768: lines 768-778
			while ($_g4_head !== null) {
				$val2 = $_g4_head->item;
				$_g4_head = $_g4_head->next;
				$f3 = $val2;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:769: characters 5-21
				$bad = false;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:770: lines 770-774
				$_g4 = 0;
				$_g5 = $table->relations;
				while ($_g4 < $_g5->length) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:770: characters 10-11
					$r = ($_g5->arr[$_g4] ?? null);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:770: lines 770-774
					++$_g4;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:771: lines 771-774
					if (($r->key === $f3->name) && ($r->className === "db.File")) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:772: characters 7-10
						$bad = true;
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:773: characters 7-12
						break;
					}
				}

				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:775: lines 775-776
				if ($bad) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:776: characters 6-14
					continue;
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:777: characters 5-24
				$fields->arr[$fields->length] = $f3->name;
				++$fields->length;

			}

		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:781: characters 3-56
		$this->style->beginForm(($table->className??'null') . "/search", null, $table->name);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:782: lines 782-793
		$_g41 = 0;
		while ($_g41 < $fields->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:782: characters 8-9
			$f4 = ($fields->arr[$_g41] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:782: lines 782-793
			++$_g41;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:783: characters 4-33
			$t = ($table->hfields->data[$f4] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:784: lines 784-785
			if ($t === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:785: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:786: lines 786-791
			$t1 = null;
			if ($t === null) {
				$t1 = $t;
			} else {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:786: characters 20-21
				$__hx__switch = ($t->index);
				if ($__hx__switch === 0 || $__hx__switch === 2) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:786: lines 786-791
					$t1 = RecordType::DInt();
				} else if ($__hx__switch === 4) {
					$t1 = RecordType::DFloat();
				} else if ($__hx__switch === 14 || $__hx__switch === 15) {
					$t1 = RecordType::DTinyText();
				} else {
					$t1 = $t;
				}
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:792: characters 55-99
			$tmp = ($params === null ? null : ($params->data[$f4] ?? null));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:792: characters 4-100
			$this->inputField($table, new HxAnon([
				"name" => $f4,
				"type" => $t1,
			]), null, false, $tmp);
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:794: characters 3-28
		$this->style->addSubmit("Search");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:795: characters 3-18
		$this->style->endForm();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:797: characters 3-30
		$this->style->beginTable("results");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:798: characters 3-33
		$this->style->beginLine(true, "header");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:799: characters 3-24
		$this->style->text("actions");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:801: lines 801-820
		if (($sinfos !== null) && ($sinfos->names !== null)) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:802: lines 802-810
			$_g51 = 0;
			$_g6 = $sinfos->names;
			while ($_g51 < $_g6->length) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:802: characters 9-10
				$f5 = ($_g6->arr[$_g51] ?? null);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:802: lines 802-810
				++$_g51;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:803: characters 5-24
				$this->style->nextRow(true);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:804: lines 804-809
				if (array_key_exists($f5, $table->hfields->data)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:805: characters 6-29
					$cur = $order === $f5;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:806: characters 6-36
					$curNeg = $order === ("-" . ($f5??'null'));
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:807: characters 6-115
					$this->style->link(($table->className??'null') . "/search?" . ($paramsStr??'null') . "__o=" . ((($cur ? "-" . ($f5??'null') : $f5))??'null'), ((($cur ? "+" : ($curNeg ? "-" : "")))??'null') . ($f5??'null'));
				} else {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:809: characters 6-19
					$this->style->text($f5);
				}
			}
		} else {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:812: characters 14-26
			$_g5_head = $table->fields->h;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:812: lines 812-819
			while ($_g5_head !== null) {
				$val3 = $_g5_head->item;
				$_g5_head = $_g5_head->next;
				$f6 = $val3;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:813: lines 813-814
				if ($this->has($rights->invisible, $f6->name)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:814: characters 6-14
					continue;
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:815: characters 5-24
				$this->style->nextRow(true);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:816: characters 5-33
				$cur1 = $order === $f6->name;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:817: characters 5-40
				$curNeg1 = $order === ("-" . ($f6->name??'null'));
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:818: characters 5-129
				$this->style->link(($table->className??'null') . "/search?" . ($paramsStr??'null') . "__o=" . ((($cur1 ? "-" . ($f6->name??'null') : $f6->name))??'null'), ((($cur1 ? "+" : ($curNeg1 ? "-" : "")))??'null') . ($f6->name??'null'));
			}
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:821: characters 3-18
		$this->style->endLine();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:823: characters 3-19
		$odd = false;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:824: characters 13-20
		$_g5_head1 = $results->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:824: lines 824-870
		while ($_g5_head1 !== null) {
			$val4 = $_g5_head1->item;
			$_g5_head1 = $_g5_head1->next;
			$r1 = $val4;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:825: characters 12-35
			$k_head = $table->fields->h;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:826: characters 4-46
			$this->style->beginLine(null, ($odd ? "odd" : null));
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:827: characters 4-67
			$this->style->link(($table->className??'null') . "/edit/" . ($table->identifier($r1)??'null'), "Edit");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:828: characters 4-7
			$odd = !$odd;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:829: lines 829-868
			if (($sinfos !== null) && ($sinfos->names !== null)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:830: characters 5-36
				$rinfos = $this->getSearchInfos($r1);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:831: lines 831-834
				$_g52 = 0;
				$_g61 = $rinfos->values;
				while ($_g52 < $_g61->length) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:831: characters 10-11
					$v1 = ($_g61->arr[$_g52] ?? null);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:831: lines 831-834
					++$_g52;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:832: characters 6-26
					$this->style->nextRow(false);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:833: characters 6-31
					$this->style->text(\Std::string($v1));
				}

			} else {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:836: characters 5-30
				$rinst = $this->getRights($r1);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:837: lines 837-867
				while ($k_head !== null) {
					$val5 = $k_head->item;
					$k_head = $k_head->next;
					$f7 = $val5;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:838: lines 838-839
					if ($this->has($rights->invisible, $f7->name)) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:839: characters 7-15
						continue;
					}
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:840: characters 6-41
					$data = \Reflect::field($r1, $f7->name);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:841: characters 6-113
					$str = null;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:841: characters 16-112
					try {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:841: characters 6-113
						$str = \Std::string($data);
					} catch (\Throwable $__hx__caught_e) {
						CallStack::saveExceptionTrace($__hx__caught_e);
						$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
						$e = $__hx__real_e;
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:841: characters 60-97
						if (!($data instanceof \Date)) {
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:841: characters 83-97
							throw (is_object($__hx__throw = $e) && $__hx__throw instanceof \Throwable ? $__hx__throw : new HxException($__hx__throw));
						}
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:841: characters 6-113
						$str = "#INVALID";
					}
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:842: lines 842-843
					if (mb_strlen($str) >= 20) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:843: characters 7-10
						$str = (mb_substr($str, 0, 17)??'null') . "...";
					}
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:844: characters 6-26
					$this->style->nextRow(false);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:845: lines 845-866
					if ($this->has($rinst->invisible, $f7->name)) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:846: characters 7-24
						$this->style->text("???");
					} else if ($data === null) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:848: characters 7-22
						$this->style->text($str);
					} else {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:849: characters 19-25
						$_g53 = $f7->type;
						$__hx__switch = ($_g53->index);
						if ($__hx__switch === 10) {
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:853: characters 7-35
							$this->style->text(mb_substr($str, 0, 10));
						} else if ($__hx__switch === 20) {
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:851: characters 7-38
							$this->style->text(Id::decode($data), $str);
						} else if ($__hx__switch === 23) {
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:854: characters 18-23
							$flags = $_g53->params[0];
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:855: characters 7-19
							$fl = new \Array_hx();
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:856: lines 856-858
							$_g54 = 0;
							$_g62 = $flags->length;
							while ($_g54 < $_g62) {
								$i = $_g54++;
								#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:857: lines 857-858
								if (($data & (1 << $i)) !== 0) {
									#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:858: characters 9-26
									$fl->arr[$fl->length] = ($flags->arr[$i] ?? null);
									++$fl->length;
								}
							}

							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:859: characters 7-10
							$str = $fl->join(",");
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:860: lines 860-863
							if (mb_strlen($str) >= 20) {
								#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:861: characters 8-71
								$this->style->text((mb_substr($str, 0, 17)??'null') . "...", ($fl->join(",")??'null') . " (" . ($data??'null') . ")");
							} else {
								#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:863: characters 8-36
								$this->style->text($str, "(" . ($data??'null') . ")");
							}

						} else {
							#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:865: characters 7-22
							$this->style->text($str);
						}
					}
				}
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:869: characters 4-19
			$this->style->endLine();
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:871: characters 3-19
		$this->style->endTable();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:873: lines 873-874
		if ($order !== null) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:874: characters 4-33
			$paramsStr = ($paramsStr??'null') . "__o=" . ($order??'null') . ";";
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:876: lines 876-879
		if ($page > 0) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:877: characters 4-79
			$this->style->link(($table->className??'null') . "/search?" . ($paramsStr??'null') . "__p=" . (($page - 1)??'null'), "Previous");
		} else {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:879: characters 4-26
			$this->style->text("Previous");
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:880: characters 3-20
		$this->style->text(" | ");
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:881: lines 881-884
		if ($hasNext) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:882: characters 4-75
			$this->style->link(($table->className??'null') . "/search?" . ($paramsStr??'null') . "__p=" . (($page + 1)??'null'), "Next");
		} else {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:884: characters 4-22
			$this->style->text("Next");
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:885: characters 3-14
		$this->style->end();
	}

	/**
	 * @param TableInfos $t
	 * @param \Array_hx $act
	 * @param string $text
	 * @param bool $def
	 * 
	 * @return void
	 */
	public function syncAction ($t, $act, $text, $def = null) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:889: lines 889-892
		if (!$this->hasSyncAction) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:890: characters 4-21
			$this->style->beginList();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:891: characters 4-24
			$this->hasSyncAction = true;
		}
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:893: characters 3-20
		$this->style->beginItem();
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:894: characters 3-80
		$this->style->checkBox(($t->className??'null') . "@" . ($act->join("@")??'null'), ($def === null ? true : $def));
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:895: characters 3-19
		$this->style->text($text);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:896: characters 3-18
		$this->style->endItem();
	}

	/**
	 * @param string $fname
	 * @param string $v
	 * @param RecordType $ftype
	 * @param TableInfos $table
	 * 
	 * @return mixed
	 */
	public function updateField ($fname, $v, $ftype, $table) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:301: lines 301-429
		$__hx__switch = ($ftype->index);
		if ($__hx__switch === 1) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:317: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:317: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:318: characters 4-26
			return \Std::parseInt($v);
		} else if ($__hx__switch === 0 || $__hx__switch === 2 || $__hx__switch === 4) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:303: characters 4-15
			return null;
		} else if ($__hx__switch === 3 || $__hx__switch === 23) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:320: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:320: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:321: characters 4-28
			$i = \Std::parseInt($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:322: lines 322-323
			if ($i < 0) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:323: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:324: characters 4-12
			return $i;
		} else if ($__hx__switch === 5) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:362: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:362: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:363: characters 4-30
			$i1 = \Std::parseFloat($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:364: lines 364-365
			if (($i1 === null) || !Boot::equal(fmod($i1, 1), 0) || ($i1 < -9223372036854775808.0) || ($i1 > 9223372036854775807.0)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:365: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:366: characters 4-12
			return $i1;
		} else if ($__hx__switch === 6 || $__hx__switch === 7) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:368: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:368: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:369: characters 4-31
			$fl = \Std::parseFloat($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:370: lines 370-371
			if (is_nan($fl)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:371: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:372: characters 4-13
			return $fl;
		} else if ($__hx__switch === 8) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:396: characters 4-24
			return $v === "true";
		} else if ($__hx__switch === 9) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:373: characters 16-17
			$n = $ftype->params[0];
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:374: lines 374-375
			if (mb_strlen($v) > $n) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:375: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:376: characters 4-12
			return $v;
		} else if ($__hx__switch === 10) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:305: characters 4-110
			$d = null;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:305: characters 12-109
			if (($v === "NOW") || ($v === "NOW()")) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:305: characters 4-110
				$d = \Date::now();
			} else {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:305: characters 61-109
				try {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:305: characters 4-110
					$d = \Date::fromString($v);
				} catch (\Throwable $__hx__caught_e) {
					CallStack::saveExceptionTrace($__hx__caught_e);
					$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
					$e = $__hx__real_e;
					$d = null;
				}
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:306: lines 306-307
			if ($d === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:307: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:308: characters 4-53
			try {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:308: characters 8-20
				$d->toString();
			} catch (\Throwable $__hx__caught_e) {
				CallStack::saveExceptionTrace($__hx__caught_e);
				$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
				$e1 = $__hx__real_e;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:308: characters 42-53
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:309: characters 4-12
			return $d;
		} else if ($__hx__switch === 11 || $__hx__switch === 12) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:311: characters 4-110
			$d1 = null;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:311: characters 12-109
			if (($v === "NOW") || ($v === "NOW()")) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:311: characters 4-110
				$d1 = \Date::now();
			} else {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:311: characters 61-109
				try {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:311: characters 4-110
					$d1 = \Date::fromString($v);
				} catch (\Throwable $__hx__caught_e) {
					CallStack::saveExceptionTrace($__hx__caught_e);
					$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
					$e2 = $__hx__real_e;
					$d1 = null;
				}
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:312: lines 312-313
			if ($d1 === null) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:313: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:314: characters 4-53
			try {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:314: characters 8-20
				$d1->toString();
			} catch (\Throwable $__hx__caught_e) {
				CallStack::saveExceptionTrace($__hx__caught_e);
				$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
				$e3 = $__hx__real_e;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:314: characters 42-53
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:315: characters 4-12
			return $d1;
		} else if ($__hx__switch === 13) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:378: lines 378-379
			if (mb_strlen($v) > 255) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:379: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:380: characters 4-12
			return $v;
		} else if ($__hx__switch === 14 || $__hx__switch === 16) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:382: lines 382-383
			if (mb_strlen($v) > 65535) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:383: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:384: characters 4-12
			return $v;
		} else if ($__hx__switch === 17) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:394: characters 4-12
			return $v;
		} else if ($__hx__switch === 15 || $__hx__switch === 18) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:386: lines 386-387
			if (mb_strlen($v) > 16777215) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:387: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:388: characters 4-12
			return $v;
		} else if ($__hx__switch === 19) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:389: characters 15-16
			$n1 = $ftype->params[0];
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:390: lines 390-391
			if (mb_strlen($v) > $n1) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:391: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:392: characters 4-12
			return $v;
		} else if ($__hx__switch === 20) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:398: characters 4-29
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:398: characters 18-29
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:399: characters 11-53
			try {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:399: characters 15-27
				return Id::encode($v);
			} catch (\Throwable $__hx__caught_e) {
				CallStack::saveExceptionTrace($__hx__caught_e);
				$__hx__real_e = ($__hx__caught_e instanceof HxException ? $__hx__caught_e->e : $__hx__caught_e);
				$e4 = $__hx__real_e;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:399: characters 49-53
				return null;
			}
		} else if ($__hx__switch === 21) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:401: characters 4-37
			return (new Serialized($v))->encode();
		} else if ($__hx__switch === 22) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:408: characters 4-9
			throw new HxException("DNekoSerialized is only available on neko target");
		} else if ($__hx__switch === 24) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:326: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:326: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:327: characters 4-28
			$i2 = \Std::parseInt($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:328: lines 328-329
			if (($i2 < -128) || ($i2 > 127)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:329: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:330: characters 4-12
			return $i2;
		} else if ($__hx__switch === 25) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:332: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:332: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:333: characters 4-28
			$i3 = \Std::parseInt($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:334: lines 334-335
			if (($i3 < 0) || ($i3 > 255)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:335: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:336: characters 4-12
			return $i3;
		} else if ($__hx__switch === 26) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:338: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:338: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:339: characters 4-28
			$i4 = \Std::parseInt($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:340: lines 340-341
			if (($i4 < -32768) || ($i4 > 32767)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:341: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:342: characters 4-12
			return $i4;
		} else if ($__hx__switch === 27) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:344: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:344: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:345: characters 4-28
			$i5 = \Std::parseInt($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:346: lines 346-347
			if (($i5 < 0) || ($i5 > 65535)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:347: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:348: characters 4-12
			return $i5;
		} else if ($__hx__switch === 28) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:350: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:350: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:351: characters 4-28
			$i6 = \Std::parseInt($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:352: lines 352-353
			if (($i6 < -8388608) || ($i6 > 8388607)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:353: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:354: characters 4-12
			return $i6;
		} else if ($__hx__switch === 29) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:356: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:356: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:357: characters 4-28
			$i7 = \Std::parseInt($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:358: lines 358-359
			if (($i7 < 0) || ($i7 > 16777215)) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:359: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:360: characters 4-12
			return $i7;
		} else if ($__hx__switch === 30) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:412: characters 4-39
			$s = (new Serialized($v))->encode();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:413: lines 413-414
			if (mb_strlen($s) > 16777215) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:414: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:416: characters 12-35
			$table1 = $table->manager;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:416: characters 55-79
			$tmp = Unserializer::run($s);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:416: characters 5-80
			return $table1->doSerialize($fname, $tmp);
		} else if ($__hx__switch === 31) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:420: characters 14-15
			$e5 = $ftype->params[0];
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:421: characters 4-26
			if ($v === "") {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:421: characters 18-26
				return 0;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:422: characters 4-28
			$i8 = \Std::parseInt($v);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:423: characters 4-33
			$ev = \Type::resolveEnum($e5);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:424: lines 424-425
			if (($i8 < 0) || (($ev !== null) && ($i8 >= \Type::getEnumConstructs($ev)->length))) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:425: characters 5-16
				return null;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:426: characters 4-12
			return $i8;
		} else if ($__hx__switch === 32 || $__hx__switch === 33) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:428: characters 4-9
			throw new HxException("assert");
		}
	}

	/**
	 * Sync some of the object fields from the web request
	 * 
	 * @param TableInfos $table
	 * @param StringMap $params
	 * 
	 * @return void
	 */
	public function updateParams ($table, $params) {
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:641: characters 3-45
		$tmp = Web::getMultipart($this->maxUploadSize);
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:642: characters 13-23
		$k = new NativeIndexedArrayIterator(array_map("strval", array_keys($tmp->data)));
		while ($k->hasNext()) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:642: lines 642-643
			$k1 = $k->next();
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:643: characters 4-28
			$value = ($tmp->data[$k1] ?? null);
			$params->data[$k1] = $value;
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:644: lines 644-652
		$_g = 0;
		$_g1 = $table->relations;
		while ($_g < $_g1->length) {
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:644: characters 8-9
			$r = ($_g1->arr[$_g] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:644: lines 644-652
			++$_g;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:645: characters 4-31
			$p = ($params->data[$r->prop] ?? null);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:646: characters 4-25
			$params->remove($r->prop);
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:647: lines 647-648
			if (($p === null) || ($p === "")) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:648: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:649: characters 4-23
			$params->data[$r->key] = $p;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:650: characters 4-34
			$params->remove(($r->prop??'null') . "__data");
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:651: characters 4-35
			$params->data[($r->key??'null') . "__data"] = "on";
		}

		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:653: characters 13-25
		$_g2_head = $table->fields->h;
		#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:653: lines 653-676
		while ($_g2_head !== null) {
			$val = $_g2_head->item;
			$_g2_head = $_g2_head->next;
			$f = $val;
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:654: characters 12-18
			$_g2 = $f->type;
			if ($_g2->index === 23) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:655: characters 16-21
				$flags = $_g2->params[0];
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:656: characters 5-18
				$vint = 0;
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:657: lines 657-659
				$_g21 = 0;
				$_g3 = $flags->length;
				while ($_g21 < $_g3) {
					$i = $_g21++;
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:658: lines 658-659
					if (array_key_exists(($f->name??'null') . "_" . (($flags->arr[$i] ?? null)??'null'), $params->data)) {
						#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:659: characters 7-21
						$vint |= 1 << $i;
					}
				}

				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:660: lines 660-663
				if (array_key_exists($f->name, $table->nulls->data) && !array_key_exists(($f->name??'null') . "__data", $params->data) && ($vint === 0)) {
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:661: characters 6-27
					$params->remove($f->name);
					#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:662: characters 6-14
					continue;
				}
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:664: characters 5-41
				$key = $f->name;
				$value1 = \Std::string($vint);
				$params->data[$key] = $value1;

				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:665: characters 5-42
				$params->data[($f->name??'null') . "__data"] = "true";

			}

			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:668: lines 668-671
			if (array_key_exists($f->name, $table->nulls->data) && !array_key_exists(($f->name??'null') . "__data", $params->data) && ((($params->data[$f->name] ?? null) === "") || (($params->data[$f->name] ?? null) === null))) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:669: characters 5-26
				$params->remove($f->name);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:670: characters 5-13
				continue;
			}
			#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:672: lines 672-675
			if ($f->type === RecordType::DBool()) {
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:673: characters 5-35
				$v = array_key_exists($f->name, $params->data);
				#/home/bubar/projects/spod/src/sys/db/admin/Admin.hx:674: characters 5-51
				$params->data[$f->name] = ($v ? "true" : "false");
			}
		}

	}
}

Boot::registerClass(Admin::class, 'sys.db.admin.Admin');
