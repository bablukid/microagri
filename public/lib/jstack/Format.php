<?php
/**
 * Generated by Haxe 4.0.0-rc.1+1fdd3d5
 */

namespace jstack;

use \php\Boot;
use \haxe\StackItem;

/**
 * Call stack formatting utils.
 */
class Format {
	/**
	 * @param string $format
	 * @param StackItem $item
	 * 
	 * @return string
	 */
	static public function itemToFormat ($format, $item) {
		#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:53: lines 53-68
		$__hx__switch = ($item->index);
		if ($__hx__switch === 0) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:55: characters 17-38
			return "a C function";
		} else if ($__hx__switch === 1) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:56: characters 25-26
			$m = $item->params[0];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:57: characters 17-35
			return "module " . ($m??'null');
		} else if ($__hx__switch === 2) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:58: characters 33-37
			$line = $item->params[2];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:58: characters 28-32
			$file = $item->params[1];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:58: characters 26-27
			$s = $item->params[0];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:59: lines 59-61
			if (mb_substr($file, 0, mb_strlen("file://")) === "file://") {
				#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:60: characters 28-57
				$file = mb_substr($file, mb_strlen("file://"), null);
			}
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:62: characters 17-73
			$symbol = ($s === null ? "" : Format::itemToFormat($format, $s));
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:63: characters 17-109
			return \StringTools::replace(\StringTools::replace(\StringTools::replace($format, "%file%", $file), "%line%", "" . ($line??'null')), "%symbol%", $symbol);
		} else if ($__hx__switch === 3) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:64: characters 31-35
			$meth = $item->params[1];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:64: characters 25-30
			$cname = $item->params[0];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:65: characters 17-38
			return "" . ($cname??'null') . "." . ($meth??'null');
		} else if ($__hx__switch === 4) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:66: characters 32-33
			$n = $item->params[0];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:67: characters 17-44
			return "local function #" . ($n??'null');
		}
	}

	/**
	 * @param \StringBuf $buf
	 * @param StackItem $item
	 * 
	 * @return void
	 */
	static public function itemToString ($buf, $item) {
		#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:27: lines 27-49
		$__hx__switch = ($item->index);
		if ($__hx__switch === 0) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:29: characters 17-40
			$buf->add("a C function");
		} else if ($__hx__switch === 1) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:30: characters 25-26
			$m = $item->params[0];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:31: characters 17-35
			$buf->add("module ");
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:32: characters 17-27
			$buf->add($m);

		} else if ($__hx__switch === 2) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:33: characters 38-42
			$line = $item->params[2];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:33: characters 32-36
			$file = $item->params[1];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:33: characters 26-30
			$item1 = $item->params[0];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:34: lines 34-37
			if ($item1 !== null) {
				#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:35: characters 21-44
				Format::itemToString($buf, $item1);
				#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:36: characters 21-34
				$buf->add(" (");
			}
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:38: characters 17-30
			$buf->add($file);
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:39: characters 17-34
			$buf->add(" line ");
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:40: characters 17-30
			$buf->add($line);
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:41: characters 17-47
			if ($item1 !== null) {
				#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:41: characters 35-47
				$buf->add(")");
			}

		} else if ($__hx__switch === 3) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:42: characters 31-35
			$meth = $item->params[1];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:42: characters 25-30
			$cname = $item->params[0];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:43: characters 17-31
			$buf->add($cname);
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:44: characters 17-29
			$buf->add(".");
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:45: characters 17-30
			$buf->add($meth);

		} else if ($__hx__switch === 4) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:46: characters 32-33
			$n = $item->params[0];
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:47: characters 17-44
			$buf->add("local function #");
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:48: characters 17-27
			$buf->add($n);

		}
	}

	/**
	 * @param \Array_hx $stack
	 * 
	 * @return string
	 */
	static public function toString ($stack) {
		#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:12: characters 9-40
		$format = null;
		#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:13: characters 9-35
		$buf = new \StringBuf();
		#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:14: lines 14-22
		$_g = 0;
		while ($_g < $stack->length) {
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:14: characters 14-18
			$item = ($stack->arr[$_g] ?? null);
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:14: lines 14-22
			++$_g;
			#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:15: lines 15-21
			if ($format === null) {
				#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:16: characters 17-42
				$buf->add("\x0ACalled from ");
				#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:17: characters 17-40
				Format::itemToString($buf, $item);
			} else {
				#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:19: characters 17-30
				$buf->add("\x0A");
				#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:20: characters 17-52
				$buf->add(Format::itemToFormat($format, $item));
			}
		}

		#/home/bubar/haxe/haxe_libraries/jstack/2.3.11/haxelib/src/jstack/Format.hx:23: characters 9-30
		return $buf->b;
	}
}

Boot::registerClass(Format::class, 'jstack.Format');
