<?php
/**
 * Generated by Haxe 4.0.0-rc.1+1fdd3d5
 */

namespace sugoi\tools;

use \php\Boot;
use \php\Web;
use \haxe\ds\StringMap;
use \php\_Boot\HxException;

class Utils {
	/**
	 * @param int $maxSize
	 * 
	 * @return StringMap
	 */
	static public function getMultipart ($maxSize) {
		#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:7: characters 3-21
		$h = new StringMap();
		#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:8: characters 3-30
		$buf = null;
		#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:9: characters 3-22
		$curname = null;
		#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:10: characters 3-23
		$curfname = null;
		#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:11: lines 11-39
		Web::parseMultipart(function ($p, $n)  use (&$buf, &$maxSize, &$curname, &$curfname, &$h) {
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:13: lines 13-18
			if ($curname !== null) {
				#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:14: characters 5-34
				$h->data[$curname] = $buf->b;
				#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:15: lines 15-16
				if ($curfname !== null) {
					#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:16: characters 6-41
					$h->data[($curname??'null') . "_filename"] = $curfname;
				}
				#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:17: characters 5-20
				$curfname = null;
			}
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:20: characters 4-15
			$curname = $p;
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:21: characters 4-16
			$curfname = $n;
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:23: characters 4-25
			$buf = new \StringBuf();
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:24: characters 4-23
			$maxSize -= mb_strlen($p);
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:25: lines 25-26
			if ($maxSize < 0) {
				#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:26: characters 5-10
				throw new HxException("multipart_maximum_size_reached");
			}
		}, function ($str, $pos, $len)  use (&$buf, &$maxSize) {
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:30: characters 4-18
			$maxSize -= $len;
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:31: lines 31-32
			if ($maxSize < 0) {
				#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:32: characters 5-10
				throw new HxException("multipart_maximum_size_reached");
			}
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:36: characters 4-40
			$s = $str->toString();
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:36: characters 4-7
			$buf1 = $buf;
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:36: characters 4-40
			$buf1->b = ($buf1->b??'null') . (mb_substr($s, $pos, $len)??'null');

		});
		#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:41: lines 41-43
		if ($curname !== null) {
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:42: characters 4-33
			$h->data[$curname] = $buf->b;
		}
		#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:44: lines 44-46
		if ($curfname !== null) {
			#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:45: characters 4-39
			$h->data[($curname??'null') . "_filename"] = $curfname;
		}
		#/home/bubar/projects/sugoi/src/sugoi/tools/Utils.hx:47: characters 3-11
		return $h;
	}
}

Boot::registerClass(Utils::class, 'sugoi.tools.Utils');
